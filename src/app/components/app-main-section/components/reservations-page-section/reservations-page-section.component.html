<h1 class="section-title">
  {{ 'MAIN.RESERVATIONS.TITLE' | translate }}
</h1>

<form nz-form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="form-container" nzLayout="vertical">
  <h2 class="form_header">
    {{ 'MAIN.RESERVATIONS.FORM.TITLE' | translate }}
  </h2>

  <div nz-row [nzGutter]="16">
    <div nz-col [nzXs]="24" [nzSm]="12">
      <nz-form-item>
        <nz-form-label [nzFor]="'firstName'">
          {{ 'MAIN.RESERVATIONS.FORM.FIRST_NAME' | translate }}
        </nz-form-label>
        <nz-form-control [nzValidateStatus]="getNzStatus('firstName')">
          <input nz-input id="firstName" formControlName="firstName"
                 [placeholder]="'MAIN.RESERVATIONS.FORM.FIRST_NAME' | translate"/>
          <nz-form-explain class="error"
                           *ngIf="userForm.get('firstName')?.invalid && userForm.get('firstName')?.touched">
            {{ 'MAIN.RESERVATIONS.FORM.ERRORS.FIRST_NAME' | translate }}
          </nz-form-explain>
        </nz-form-control>
      </nz-form-item>
    </div>

    <div nz-col [nzXs]="24" [nzSm]="12">
      <nz-form-item>
        <nz-form-label [nzFor]="'secondName'">
          {{ 'MAIN.RESERVATIONS.FORM.LAST_NAME' | translate }}
        </nz-form-label>
        <nz-form-control [nzValidateStatus]="getNzStatus('secondName')">
          <input nz-input id="secondName" formControlName="secondName"
                 [placeholder]="'MAIN.RESERVATIONS.FORM.LAST_NAME' | translate"/>
          <nz-form-explain *ngIf="userForm.get('secondName')?.invalid && userForm.get('secondName')?.touched"
                           class="error">
            {{ 'MAIN.RESERVATIONS.FORM.ERRORS.LAST_NAME' | translate }}
          </nz-form-explain>
        </nz-form-control>
      </nz-form-item>
    </div>
  </div>

  <nz-form-item>
    <nz-form-label [nzFor]="'phoneNumber'">
      {{ 'MAIN.RESERVATIONS.FORM.PHONE_NUMBER' | translate }}
    </nz-form-label>
    <nz-form-control [nzValidateStatus]="getNzStatus('phoneNumber')">
      <input nz-input id="phoneNumber" type="tel" formControlName="phoneNumber"
             [placeholder]="'MAIN.RESERVATIONS.FORM.PHONE_NUMBER' | translate"/>
      <nz-form-explain *ngIf="userForm.get('phoneNumber')?.invalid && userForm.get('phoneNumber')?.touched"
                       class="error">
        {{ 'MAIN.RESERVATIONS.FORM.ERRORS.PHONE_NUMBER' | translate }}
      </nz-form-explain>
    </nz-form-control>
  </nz-form-item>

  <nz-form-item>
    <nz-form-label [nzFor]="'email'">
      {{ 'MAIN.RESERVATIONS.FORM.E_MAIL' | translate }}
    </nz-form-label>
    <nz-form-control [nzValidateStatus]="getNzStatus('email')">
      <input nz-input id="email" type="email" formControlName="email"
             [placeholder]="'MAIN.RESERVATIONS.FORM.E_MAIL' | translate"/>
      <nz-form-explain *ngIf="userForm.get('email')?.invalid && userForm.get('email')?.touched" class="error">
        {{ 'MAIN.RESERVATIONS.FORM.ERRORS.E_MAIL' | translate }}
      </nz-form-explain>
    </nz-form-control>
  </nz-form-item>

  <nz-form-item>
    <nz-form-label [nzFor]="'date'">
      {{ 'MAIN.RESERVATIONS.FORM.DATE' | translate }}
    </nz-form-label>
    <nz-form-control [nzValidateStatus]="getNzStatus('date')">
      <nz-date-picker id="date"
                      formControlName="date"
                      [nzPlaceHolder]="'MAIN.RESERVATIONS.FORM.DATE' | translate"
                      [nzDisabledDate]="disableBeforeMinDate"
                      [nzShowToday]="false"
                      [nzInputReadOnly]="true"
                      [nzStatus]="getNzStatus('date')"
                      style="width: 100%;"></nz-date-picker>
      <nz-form-explain *ngIf="userForm.get('date')?.invalid && userForm.get('date')?.touched" class="error">
        {{ 'MAIN.RESERVATIONS.FORM.ERRORS.DATE' | translate }}
      </nz-form-explain>
    </nz-form-control>
  </nz-form-item>

  <nz-form-item>
    <nz-form-label [nzFor]="'reservationTime'">
      {{ 'MAIN.RESERVATIONS.FORM.TIME' | translate }}
    </nz-form-label>
    <nz-form-control [nzValidateStatus]="getNzStatus('reservationTime')">
      <nz-time-picker
        class="timepicker-no-now"
        formControlName="reservationTime"
        [nzFormat]="'HH:mm'"
        [nzMinuteStep]="60"
        [nzDisabledHours]="getDisabledHours"
        [nzHideDisabledOptions]="true"
        [nzInputReadOnly]="true"
        [nzNowText]="' '"
        [nzDisabled]="!userForm.get('date')?.value"
        style="width: 100%;"
      ></nz-time-picker>

      <nz-form-extra nz-tooltip *ngIf="userForm.get('date')?.value">
        {{ 'MAIN.RESERVATIONS.FORM.ERRORS.TIME_HINT' | translate }}
      </nz-form-extra>
      <nz-form-explain class="error"
                       *ngIf="userForm.get('reservationTime')?.invalid && userForm.get('reservationTime')?.touched">
        {{ 'MAIN.RESERVATIONS.FORM.ERRORS.TIME' | translate }}
      </nz-form-explain>
      <nz-form-explain *ngIf="userForm.get('reservationTime')?.hasError('notRoundHour')" class="error">
        Please select a full hour (e.g., 13:00).</nz-form-explain>
    </nz-form-control>
  </nz-form-item>
  <nz-form-item>
    <nz-form-control>
      <nz-radio-group class="custom-radio-group"
                      formControlName="option">
        <label nz-radio [nzValue]="'Group training'">
          {{ 'MAIN.RESERVATIONS.FORM.GROUP_TRAINING' | translate }}
        </label>
        <label nz-radio [nzValue]="'Individual training'">
          {{ 'MAIN.RESERVATIONS.FORM.INDIVIDUAL_TRAINING' | translate }}
        </label>
      </nz-radio-group>
    </nz-form-control>
  </nz-form-item>

  <nz-form-item>
    <nz-form-control>
      <button type="submit" [disabled]="!userForm.valid">
        {{ 'MAIN.RESERVATIONS.FORM.SUBMIT' | translate }}
      </button>
    </nz-form-control>
  </nz-form-item>

  <app-loading-spinner [isLoading]="isLoading"></app-loading-spinner>
</form>

<div class="modal-overlay" *ngIf="showModal">
  <div class="modal-box">
    <h2 class="modal-title">
      {{
        modalSuccess
          ? ('MAIN.SHARED.ERRORS.MODAL.TITLE_SUCCESS' | translate)
          : ('MAIN.SHARED.ERRORS.MODAL.TITLE_FAILURE' | translate)
      }}
    </h2>
    <p class="modal-message">
      {{
        modalSuccess
          ? ('MAIN.SHARED.ERRORS.MODAL.SUCCESS_DESCRIPTION' | translate)
          : ('MAIN.SHARED.ERRORS.MODAL.FAILURE_DESCRIPTION' | translate)
      }}
    </p>
    <button class="modal-close" (click)="showModal = false">{{ 'MAIN.SHARED.ERRORS.MODAL.BUTTON' | translate }}</button>
  </div>
</div>
<app-working-hours></app-working-hours>
